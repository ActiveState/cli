project: https://platform.activestate.com/ActiveState/cli?branch=main&commitID=7a2fb89c-4bf0-4bb8-b45e-88b0d8af10e4
constants:
  - CLI_BUILDFLAGS: -ldflags="-s -w"
  - CLI_PKGS: ./cmd/state
  - SET_ENV: |
      GOFLAGS='-mod=vendor'
      BUILD_TARGET_DIR=$constants.BUILD_TARGET_PREFIX_DIR/${GOARCH#amd64}
  - name: SCRIPT_EXT 
    if: ne .OS.Name "Windows" 
    value: .sh
scripts:
  - preprocess: |
      $constants.SET_ENV
      go run scripts/constants-generator/main.go -- internal/constants/generated.go
  - build: |
      $constants.SET_ENV
      go build -tags "$GO_BUILD_TAGS" -o $BUILD_TARGET_DIR/$constants.BUILD_TARGET $constants.CLI_BUILDFLAGS $constants.CLI_PKGS
events:
  - activate: |
      if ! type "go" &> /dev/null; then
        echo "go is not installed. Please install Go version 1.11 or above."
        exit 1
      fi
      git config core.hooksPath .githooks
  - name: file-changed
    scope: ["internal/locale/locales"]
    value: build
